## TransferRequestedEvent
> 송금 요청이 들어왔다는 이벤트

FDS(이상거래탐지) 쪽에서 반드시 필요한 이벤트 이다.  
“이 계좌가 누구에게 얼마를 송금하려 했다”

```json
{
  "transactionId": "snowflake-id",
  "senderId": "user-123",
  "receiverId": "user-456",
  "amount": "100.00",
  "requestedAt": "2025-08-16T11:00:00Z"
}
```

## TransferCompletedEvent
> 실제 송금이 완료됐다는 이벤트

알림/회계 시스템에서 필요한 이벤트 이다.  
“돈이 실제로 움직였다”  

```json
{
  "transactionId": "snowflake-id",
  "status": "COMPLETED",
  "completedAt": "2025-08-16T11:01:30Z"
}
```

## TransferFailedEvent
송금이 실패했을 때 (잔액 부족, 계좌 잠김 등) 이벤트
보정(Correction), FDS 패턴 학습 데이터에 중요하다.

```json
{
  "transactionId": "snowflake-id",
  "status": "FAILED",
  "reason": "INSUFFICIENT_FUNDS",
  "failedAt": "2025-08-16T11:01:00Z"
}
```

## 이벤트 설계 원칙
- Aggregate 단위
  - 송금(Transaction/Transfer Aggregate) 단위에서 발생하는 중요한 상태 전이마다 이벤트 발생
- 도메인 용어 그대로
  - TransferRequestedEvent 같은 이름으로 외부 시스템이 비즈니스 맥락을 이해 가능해야 함
- 불변 기록
  - Outbox에는 이벤트가 발생한 사실이 불변으로 남아야 함.
  - 이후 발행 여부는 published_at으로만 구분

## Outbox에 저장되는 필드
- `event_id` : Snowflake 기반 ID
- `aggregate_type` : "Transfer" (어떤 Aggregate의 이벤트인지)
- `aggregate_id` : Transaction ID
- `event_type` : "TransferRequested", "TransferCompleted", "TransferFailed"
- `payload` : 위 JSON 직렬화 결과
- `headers` : traceId, correlationId 등
- `created_at` : 이벤트 발생 시각
- `published_at` : Kafka 발행 완료 시각

> 송금 도메인에서 Outbox에 남겨야 하는 이벤트는,  
> Transaction/Transfer의 상태 전이 지점에서 발생하는 `Requested` / `Completed` / `Failed` 세가지 타입이다.
